{
	"name": "sap produto",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL/sap"
		},
		"content": {
			"query": "TRUNCATE TABLE  ODS.SAP_PRODUTO\n\nINSERT INTO ODS.SAP_PRODUTO\nSELECT  \nmara.MATNR                 AS CODIGO_PRODUTO\n,mara.J_3APGNR             AS CODIGO_MATRIZ_PRODUTO\n,mara.MTART                AS CODIGO_TIPO_PRODUTO\n,mara.PRDHA                AS CODIGO_HIERARQUIA_PRODUTO\n,mara.MATKL                AS CODIGO_GRUPO_MERCADORIA\n,mara.MSTAE                AS CODIGO_STATUS_PRODUTO\n,mara.LVORM                AS FLAG_MATERIAL_ELIMINADO\n,mara.MEINS                AS UNIDADE_MEDIDA_BASICA\n,mara.BSTME                AS UNIDADE_MEDIDA_OV\n,mara.ERSDA                AS DATA_CRIACAO_PRODUTO\n,mara.MAGRV                AS CODIGO_GRUPO_MATERIAIS_ME\n,makt.MAKTX                AS DESCRICAO_ABREVIADA_PRODUTO\n,makt.MAKTG                AS DESCRICAO_PRODUTO\n--,GrupoProduto.grupoproduto\n--,GrupoCampanha.grupoCampanha\n,ztpp_re_001.ZZMARCA       AS DESCRICAO_MARCA_PRODUTO\n,ztpp_re_001.ZZMARCADESC  \n,ztpp_re_003.ZZDESTCONFEC  AS DESCRICAO_DESTINO_CONFECCCAO \n,ztpp_re_003.ZZDESTCONFECD\n,ztpp_re_004.ZZCATPROD        \n,ztpp_re_004.ZZCATPRODESC  AS DESCRICAO_CATEGORIA_PRODUTO\n,ztpp_re_005.ZZESPECIE\n,ztpp_re_005.ZZESPECIEDESC AS DESCRICAO_ESPECIE_PRODUTO\n,ztpp_re_007.ZZCATLPROD\n,ztpp_re_007.ZZCATLPRODDESC AS DESCRICAO_CATEGORIA_LINNHA\n,ztpp_re_011.ZZGENERO       AS DESCRICAO_GENERO_PRODUTO\n,ztpp_re_011.DESCRICAO\t\tAS DESCRICAO_re_011\n,ztpp_re_012.ZZSEGMENTO     AS DESCRICAO_SEGMENTO_PRODUTO      \n,ztpp_re_012.DESCRICAO      AS DESCRICAO_re_012\n--into sap_produto_smp\nINTO ODS.SAP_PRODUTO\nFROM \n[cleansing_data].[sap_mara] as mara\ninner join [cleansing_data].[sap_makt] as makt on mara.MATNR = makt.MATNR\ninner join vw_ausp_175 as ausp_175 on ausp_175.OBJEK = mara.MATNR\n\nLEFT JOIN [cleansing_data].[sap_ausp] AS ausp_275 ON  ausp_275.OBJEK = mara.MATNR AND  ausp_275.ATINN = '0000000275' \nLEFT JOIN [cleansing_data].[sap_ausp] AS ausp_141 ON  ausp_141.OBJEK = mara.MATNR AND  ausp_141.ATINN = '0000000141' \nLEFT JOIN [cleansing_data].[sap_ausp] AS ausp_139 ON  ausp_139.OBJEK = mara.MATNR AND  ausp_139.ATINN = '0000000139' \nLEFT JOIN [cleansing_data].[sap_ausp] AS ausp_144 ON  ausp_144.OBJEK = mara.MATNR AND  ausp_144.ATINN = '0000000144' \nLEFT JOIN [cleansing_data].[sap_ausp] AS ausp_148 ON  ausp_148.OBJEK = mara.MATNR AND  ausp_148.ATINN = '0000000148' \nLEFT JOIN [cleansing_data].[sap_ausp] AS ausp_140 ON  ausp_140.OBJEK = mara.MATNR AND  ausp_140.ATINN = '0000000140' \n\nleft join [cleansing_data].[sap_ztpp_re_001] as ztpp_re_001 on ztpp_re_001.ZZMARCA = ausp_175.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_003] as ztpp_re_003 on ztpp_re_003.ZZDESTCONFEC = ausp_141.ATWRT\n\nleft join [cleansing_data].[sap_ztpp_re_005] as ztpp_re_005 on ztpp_re_005.ZZESPECIE = ausp_275.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_007] as ztpp_re_007 on ztpp_re_007.ZZCATLPROD = ausp_139.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_011] as ztpp_re_011 on ztpp_re_011.ZZGENERO = ausp_144.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_012] as ztpp_re_012 on ztpp_re_012.ZZSEGMENTO = ausp_148.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_004] as ztpp_re_004 on ztpp_re_004.ZZCATPROD = ausp_140.ATWRT\n\n\n/* GRADE */  \nselect \nsap_ausp.OBJEK\t\n--,sap_ausp.ATINN\t\n--,sap_ausp.ATZHL\t\n--,sap_ausp.MAFID\t\n--,sap_ausp.KLART\t\n--,sap_ausp.ATWRT\n--,sap_cawn.ATWRT\n--,sap_cawn.ATINN\n--,concat(sap_cawn.ATINN,sap_cawn.ATZHL) as chavewn\n--,concat(sap_cawnt.ATINN,sap_cawnt.ATZHL) as chavent\n,sap_cawnt.ATWTB AS DESCRICAO_GRADE\nfrom [cleansing_data].[sap_ausp] as sap_ausp\nleft join [cleansing_data].[sap_cawn] as sap_cawn on sap_ausp.atinn = sap_cawn.atinn\nleft join [cleansing_data].[sap_cawnt]  as sap_cawnt on concat(sap_cawn.ATINN,sap_cawn.ATZHL) =  concat(sap_cawnt.ATINN,sap_cawnt.ATZHL)\nwhere sap_ausp.ATINN = '0000000267' AND sap_cawn.ATINN = '0000000267'\nAND sap_ausp.OBJEK = '000000001000000040'\n\n/* MATERIAL PERMANENCIA */\nselect \nsap_ausp.OBJEK\t\n--,sap_ausp.ATINN\t\n--,sap_ausp.ATZHL\t\n--,sap_ausp.MAFID\t\n--,sap_ausp.KLART\t\n--,sap_ausp.ATWRT\n--,sap_cawn.ATWRT\n--,sap_cawn.ATINN\n--,concat(sap_cawn.ATINN,sap_cawn.ATZHL) as chavewn\n--,concat(sap_cawnt.ATINN,sap_cawnt.ATZHL) as chavent  \n,sap_cawnt.ATWTB AS DESCRICAO_PERMANENCIA\nfrom [cleansing_data].[sap_ausp] as sap_ausp\nleft join [cleansing_data].[sap_cawn] as sap_cawn on sap_ausp.ATWRT = sap_cawn.ATWRT\nleft join [cleansing_data].[sap_cawnt]  as sap_cawnt on concat(sap_cawn.ATINN,sap_cawn.ATZHL) =  concat(sap_cawnt.ATINN,sap_cawnt.ATZHL)\nwhere sap_ausp.ATINN = '0000000816' AND sap_cawn.ATINN = '0000000816'\nAND sap_ausp.OBJEK = '000000001000000040'\n\n\n/* CAMPOS DO PLANILH√ÉO*/\nZZMARCADESC =  [MARCA PARA]\nDESCRICAO_re_011 = [GENERO PARA], \nDESCRICAO_re_012 = [SEGMENTO PARA],\nZZESPECIEDESC = [ESPECIE PARA]\nGRUPO_PRODUTO = [GRUPO DE PRODUTO PARA], \nSUB_GRUPO_PRODUTO = [SUB GRUPO DE PRODUTO PARA]\nZZDESTCONFECD = [DESTINO CONFECCAO PARA]\nDESCRICAO_GRADE =  [GRADE PARA]\nDESCRICAO_PERMANENCIA = [PERMANENCIA PARA]\n\n\n\n ",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "Built-in",
				"databaseName": "master"
			}
		},
		"type": "SqlQuery"
	}
}