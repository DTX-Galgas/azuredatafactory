{
	"name": "sap produto",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL/sap"
		},
		"content": {
			"query": "SELECT  \nmara.MATNR\n,mara.J_3APGNR\n,mara.MTART\n,mara.PRDHA\n,mara.MATKL\n,mara.MSTAE\n,mara.LVORM\n,mara.MEINS\n,mara.BSTME\n,mara.ERSDA\n,mara.MAGRV\n,makt.MAKTX\n,makt.MAKTG\n--,GrupoProduto.grupoproduto\n--,GrupoCampanha.grupoCampanha\n,ztpp_re_001.ZZMARCA\n,ztpp_re_001.ZZMARCADESC\n,ztpp_re_003.ZZDESTCONFEC\n,ztpp_re_003.ZZDESTCONFECD\n,ztpp_re_004.ZZCATPROD\n,ztpp_re_004.ZZCATPRODESC\n,ztpp_re_005.ZZESPECIE\n,ztpp_re_005.ZZESPECIEDESC\n,ztpp_re_007.ZZCATLPROD\n,ztpp_re_007.ZZCATLPRODDESC\n,ztpp_re_011.ZZGENERO\n,ztpp_re_011.DESCRICAO\n,ztpp_re_012.ZZSEGMENTO\n,ztpp_re_012.DESCRICAO \nFROM  [cleansing_data].[sap_mara] as mara\ninner join [cleansing_data].[sap_makt] as makt on mara.MATNR = makt.MATNR\ninner join vw_ausp_175 as ausp_175 on ausp_175.OBJEK = mara.MATNR\n\nleft join vw_ausp_275 as ausp_275 on ausp_275.OBJEK = mara.MATNR\nleft join vw_ausp_141 as ausp_141 on ausp_141.OBJEK = mara.MATNR\nleft join vw_ausp_139 as ausp_139 on ausp_139.OBJEK = mara.MATNR\nleft join vw_ausp_144 as ausp_144 on ausp_144.OBJEK = mara.MATNR\nleft join vw_ausp_148 as ausp_148 on ausp_148.OBJEK = mara.MATNR\nleft join vw_ausp_140 as ausp_140 on ausp_140.OBJEK = mara.MATNR\n\n--left join vwGrupoProduto as GrupoProduto on  GrupoProduto.codigoproduto =  right(mara.MATNR ,10)  \n--left join vwGrupoCampanha as GrupoCampanha on  GrupoCampanha.codigoproduto =  right(mara.MATNR ,10)\n\nleft join [cleansing_data].[sap_ztpp_re_001] as ztpp_re_001 on ztpp_re_001.ZZMARCA = ausp_175.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_003] as ztpp_re_003 on ztpp_re_003.ZZDESTCONFEC = ausp_141.ATWRT\n\nleft join [cleansing_data].[sap_ztpp_re_005] as ztpp_re_005 on ztpp_re_005.ZZESPECIE = ausp_275.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_007] as ztpp_re_007 on ztpp_re_007.ZZCATLPROD = ausp_139.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_011] as ztpp_re_011 on ztpp_re_011.ZZGENERO = ausp_144.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_012] as ztpp_re_012 on ztpp_re_012.ZZSEGMENTO = ausp_148.ATWRT\nleft join [cleansing_data].[sap_ztpp_re_004] as ztpp_re_004 on ztpp_re_004.ZZCATPROD = ausp_140.ATWRT\n\nwhere mara.MATNR = '000000001000001768'\n \n\n/* GRADE */  \nselect \nsap_ausp.OBJEK\t\n,sap_ausp.ATINN\t\n,sap_ausp.ATZHL\t\n,sap_ausp.MAFID\t\n,sap_ausp.KLART\t\n,sap_ausp.ATWRT\n,sap_cawn.ATWRT\n,sap_cawn.ATINN\n,concat(sap_cawn.ATINN,sap_cawn.ATZHL) as chavewn\n,concat(sap_cawnt.ATINN,sap_cawnt.ATZHL) as chavent\n,sap_cawnt.ATWTB\nfrom [cleansing_data].[sap_ausp] as sap_ausp\nleft join [cleansing_data].[sap_cawn] as sap_cawn on sap_ausp.atinn = sap_cawn.atinn\nleft join [cleansing_data].[sap_cawnt]  as sap_cawnt on concat(sap_cawn.ATINN,sap_cawn.ATZHL) =  concat(sap_cawnt.ATINN,sap_cawnt.ATZHL)\nwhere sap_ausp.ATINN = '0000000267' AND sap_cawn.ATINN = '0000000267'\nAND sap_ausp.OBJEK = '000000001000000040'\n\n\n \n  \n\n/* MATERIAL PERMANENCIA */\nselect \nsap_ausp.OBJEK\t\n,sap_ausp.ATINN\t\n,sap_ausp.ATZHL\t\n,sap_ausp.MAFID\t\n,sap_ausp.KLART\t\n,sap_ausp.ATWRT\n,sap_cawn.ATWRT\n,sap_cawn.ATINN\n,concat(sap_cawn.ATINN,sap_cawn.ATZHL) as chavewn\n,concat(sap_cawnt.ATINN,sap_cawnt.ATZHL) as chavent  \n,sap_cawnt.ATWTB\nfrom [cleansing_data].[sap_ausp] as sap_ausp\nleft join [cleansing_data].[sap_cawn] as sap_cawn on sap_ausp.ATWRT = sap_cawn.ATWRT\nleft join [cleansing_data].[sap_cawnt]  as sap_cawnt on concat(sap_cawn.ATINN,sap_cawn.ATZHL) =  concat(sap_cawnt.ATINN,sap_cawnt.ATZHL)\nwhere sap_ausp.ATINN = '0000000816' AND sap_cawn.ATINN = '0000000816'\nAND sap_ausp.OBJEK = '000000001000000040'\n\n\n/* SUBLINHA */\nselect  \nsap_ausp.OBJEK\t\n,sap_ausp.ATINN\t\n,sap_ausp.ATZHL\t\n,sap_ausp.MAFID\t\n,sap_ausp.KLART\t\n,sap_ausp.ATWRT\n,sap_cawn.ATWRT\n,sap_cawn.ATINN\n,sap_cawn.ATWRT\n,sap_cawn.ATINN\n,concat(sap_cawn.ATINN,sap_cawn.ATZHL) as chavewn\n,concat(sap_cawnt.ATINN,sap_cawnt.ATZHL) as chavent\n,sap_cawnt.ATWTB\nfrom [cleansing_data].[sap_ausp] as sap_ausp\nleft join [cleansing_data].[sap_cawn] as sap_cawn on sap_ausp.ATWRT = sap_cawn.ATWRT\nleft join [cleansing_data].[sap_cawnt]  as sap_cawnt on concat(sap_cawn.ATINN,sap_cawn.ATZHL) =  concat(sap_cawnt.ATINN,sap_cawnt.ATZHL)\nwhere sap_ausp.ATINN\t = '0000000829' AND sap_cawn.ATINN = '0000000829'\nAND sap_ausp.OBJEK\t = '000000001000000040'\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "Built-in",
				"databaseName": "master"
			}
		},
		"type": "SqlQuery"
	}
}