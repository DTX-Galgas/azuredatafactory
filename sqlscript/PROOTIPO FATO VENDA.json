{
	"name": "PROOTIPO FATO VENDA",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": " SELECT TOP(10) \n CONVERT(INT,REPLACE(CONVERT(VARCHAR,CONVERT(DATE,DATA_CONFIRMACAO)),'-',''))                       AS DATA_CONFIRMACAO\n ,CONVERT(VARCHAR(5), LOJA.ESTAB_IDCIGAM)                                                           AS ESTAB_IDCIGAM\n ,CONVERT(INT,CLIENTE.CLIENTE_CODIGO)                                                               AS CLIENTE_CODIGO\n ,CONVERT(VARCHAR(10), PRODUTO.PRODUTO_MODELO )                                                     AS PRODUTO_MODELO\n , VENDAS.PRODUTO_REFERENCIA\n, UPPER(CONVERT(VARCHAR(50),ISNULL(VENDAS.MODALIDADE_VENDA,'NÃO INFORMADO'))) AS MODALIDADE_VENDA\n ,CASE\n    WHEN VENDAS.TIPO_MOVIMENTO = 'V' THEN CONVERT(VARCHAR(15),'VENDA') \n    ELSE CONVERT(VARCHAR(15),'NÃO INFORMADO') \n END                                                                                                AS TIPO_MOVIMENTO \n ,CONVERT(INT,VENDAS.NUMERO_DOCTO)                                                                  AS  NUMERO_DOCTO\n ,CONVERT(INT,VENDAS.QTD_ITEM)                                                                      AS QTD_ITEM\n ,CONVERT(NUMERIC(18,2),VENDAS.VALOR_UNITARIO)                                                      AS VALOR_UNITARIO\n ,CONVERT(NUMERIC(18,2),VENDAS.VALOR_TOTAL_ITEM)                                                    AS VALOR_TOTAL_ITEM\n FROM CLEANSING_DATA.GST_BI_VENDAS                                                                  AS VENDAS\n LEFT JOIN CLEANSING_DATA.GST_BI_ESTABELECIMENTO AS LOJA ON VENDAS.IDLOJA_CIGAM = LOJA.ESTAB_IDCIGAM\n LEFT JOIN CLEANSING_DATA.GST_BI_PRODUTOS AS PRODUTO ON VENDAS.PRODUTO =  PRODUTO.PRODUTO_MODELO \n LEFT JOIN CLEANSING_DATA.GST_BI_CLIENTES AS CLIENTE ON \n           VENDAS.IDLOJA_CIGAM = CLIENTE.ESTAB_IDCIGAM AND \n           VENDAS.CLIENTE_CODIGO = CLIENTE.CLIENTE_CODIGO\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}