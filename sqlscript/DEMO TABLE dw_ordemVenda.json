{
	"name": "DEMO TABLE dw_ordemVenda",
	"properties": {
		"content": {
			"query": "DROP TABLE dw.ordem_venda\n\nIF NOT EXISTS (SELECT * FROM sys.objects WHERE NAME = 'ordem_venda' AND TYPE = 'U')\nCREATE TABLE dw.ordem_venda\n\t(\n\t [pk_material] bigint,\n\t [pk_OrdemVenda] nvarchar(30),\n\t [pk_documento_condicao] bigint,\n\t [pk_cliente] bigint,\n\t [pk_representante] bigint,\n\t [OV - PV Comercial] nvarchar(30),\n\t [OV - PV Número] bigint,\n\t [%DataID] bigint,\n\t [OV - Número] bigint,\n\t [OV - Mês Despacho] nvarchar(30),\n\t [OV - Ano Despacho] bigint,\n\t [OV - Tipo Documento] nvarchar(30),\n\t [OV - Grupo Tp.Documento] nvarchar(30),\n\t [OV - Data Entrada] nvarchar(30),\n\t [OV - Ano Entrada] bigint,\n\t [OV - Mes Entrada] nvarchar(30),\n\t [OV - Data Entrada (Dia)] nvarchar(30),\n\t [OV - Programado] nvarchar(30),\n\t [OV - Canal Venda] nvarchar(30),\n\t [OV - Grupo Cliente] nvarchar(30),\n\t [OV - Modalidade] nvarchar(30),\n\t [OV - Entrada Ultimos 10] nvarchar(30),\n\t [OV - Período PV/Ano] nvarchar(30),\n\t [OV - Período PV] bigint,\n\t [OV - Tipo Meta] nvarchar(30),\n\t [OV - Periodo] nvarchar(30),\n\t [OV - Sigla Nome Antigo] nvarchar(3000),\n\t [OV - Sigla Nome] nvarchar(30),\n\t [OV - Regional] nvarchar(30),\n\t [Meta - Regional] nvarchar(30),\n\t [OV - Modo Envio] nvarchar(30),\n\t [OV - Valor Desconto] nvarchar(30),\n\t [OV - Item Grupo Tamanho] bigint,\n\t [OV - Item Grupo Alvo] nvarchar(30),\n\t [OV - Item Estação] nvarchar(30),\n\t [OV - Item Estação Ano] bigint,\n\t [OV - Item Coleção] nvarchar(30),\n\t [OV - Item Qtde] bigint,\n\t [OV - Item Qtde Geral] bigint,\n\t [OV - Item Valor] nvarchar(30),\n\t [OV - Item Valor Unit] nvarchar(30),\n\t [OV - Item Status] nvarchar(30),\n\t [OV - Item Equipe de Vendas] nvarchar(30),\n\t [OV - Item Sigla Nome Ajs] nvarchar(3000),\n\t [OV - Tipo Pedido] nvarchar(30),\n\t [OV - Item Mascara] nvarchar(30),\n\t [OV - BU] nvarchar(30),\n\t [OV Item - Marca Meta] nvarchar(30),\n\t [Rec. Meta Total] nvarchar(30),\n\t [OV - Item Motivo Recusa] nvarchar(30),\n\t [Representante - Codigo Ajustado] bigint,\n\t [OV - Valor Cancelado Antes PV] bigint,\n\t [OV - Valor Cancelado Depois PV] bigint,\n\t [OV - ColecaoAjustada] nvarchar(30),\n\t [OV - Item Valor Geral] nvarchar(30),\n\t [OV - Subcanal] nvarchar(30),\n\t [OV - PV To Date] nvarchar(30),\n\t [OV - Produto Grupo Temp] nvarchar(30),\n\t [OV - Chave SSS Geral] nvarchar(30),\n\t [Margem - PM] nvarchar(30),\n\t [Margem - Custo PÇ] nvarchar(30),\n\t [Margem - Perc. CustoV] nvarchar(30),\n\t [OV - Margem Liq Produto] nvarchar(30),\n\t [OV - SSS Geral] nvarchar(30),\n\t [OV - SSS Ponderado] nvarchar(30),\n\t [OV - Produto Grupo] nvarchar(30),\n\t [OV - Abertura_AnoAtual] bigint,\n\t [OV - Abertura_AnoAnterior] bigint,\n\t [OV - Segmento] nvarchar(30),\n\t [Meta - Quantidade] nvarchar(30),\n\t [Meta - Valor] nvarchar(30),\n\t [Meta - Grupo de Marca] nvarchar(30),\n\t [Meta - Marca] nvarchar(30),\n\t [Meta - Gerente Regional] nvarchar(30),\n\t [Meta - Representante] nvarchar(30),\n\t [Meta - Representante - Codigo Ajustado] nvarchar(30),\n\t [Meta - Gerente de Área Fidelizado] nvarchar(30),\n\t [Meta - Canal] nvarchar(30),\n\t [Meta - ROB Meta (Venda)] nvarchar(30),\n\t [Meta - ROB Meta] nvarchar(30),\n\t [Meta - Qtde. Meta (Venda)] nvarchar(30),\n\t [Meta - Qtde. Meta] nvarchar(30),\n\t [Meta - ROL Meta Venda] nvarchar(30),\n\t [Meta - ROL Meta] nvarchar(30),\n\t [Meta - Margem Bruta Meta Venda] nvarchar(30),\n\t [Meta - Margem Bruta Meta] nvarchar(30),\n\t [Meta - Margem Liq. Meta Venda] nvarchar(30),\n\t [Meta - Margem Liq. Meta] nvarchar(30),\n\t [Meta - Qtde. Aberturas] nvarchar(30),\n\t [Meta - Desconto Valor] nvarchar(30),\n\t [Meta - Desconto Pct] nvarchar(30),\n\t [RC - Qtde Prep] nvarchar(30),\n\t [RC - Qtde RC_Prep] nvarchar(30),\n\t [DiasVenda - Qtde] nvarchar(30),\n\t [DiasVenda - Tipo] nvarchar(30),\n\t [MetaTM - TM_Pct] nvarchar(30)\n\t)\nWITH\n\t(\n\tDISTRIBUTION = ROUND_ROBIN,\n\t CLUSTERED COLUMNSTORE INDEX\n\t -- HEAP\n\t)\nGO\n\n--Uncomment the 4 lines below to create a stored procedure for data pipeline orchestration​                 \n--CREATE PROC bulk_load_ordem_venda\n--AS\n--BEGIN\nCOPY INTO dw.ordem_venda\n(pk_material 1, pk_OrdemVenda 2, pk_documento_condicao 3, pk_cliente 4, pk_representante 5, [OV - PV Comercial] 6, [OV - PV Número] 7, [%DataID] 8, [OV - Número] 9, [OV - Mês Despacho] 10, [OV - Ano Despacho] 11, [OV - Tipo Documento] 12, [OV - Grupo Tp.Documento] 13, [OV - Data Entrada] 14, [OV - Ano Entrada] 15, [OV - Mes Entrada] 16, [OV - Data Entrada (Dia)] 17, [OV - Programado] 18, [OV - Canal Venda] 19, [OV - Grupo Cliente] 20, [OV - Modalidade] 21, [OV - Entrada Ultimos 10] 22, [OV - Período PV/Ano] 23, [OV - Período PV] 24, [OV - Tipo Meta] 25, [OV - Periodo] 26, [OV - Sigla Nome Antigo] 27, [OV - Sigla Nome] 28, [OV - Regional] 29, [Meta - Regional] 30, [OV - Modo Envio] 31, [OV - Valor Desconto] 32, [OV - Item Grupo Tamanho] 33, [OV - Item Grupo Alvo] 34, [OV - Item Estação] 35, [OV - Item Estação Ano] 36, [OV - Item Coleção] 37, [OV - Item Qtde] 38, [OV - Item Qtde Geral] 39, [OV - Item Valor] 40, [OV - Item Valor Unit] 41, [OV - Item Status] 42, [OV - Item Equipe de Vendas] 43, [OV - Item Sigla Nome Ajs] 44, [OV - Tipo Pedido] 45, [OV - Item Mascara] 46, [OV - BU] 47, [OV Item - Marca Meta] 48, [Rec. Meta Total] 49, [OV - Item Motivo Recusa] 50, [Representante - Codigo Ajustado] 51, [OV - Valor Cancelado Antes PV] 52, [OV - Valor Cancelado Depois PV] 53, [OV - ColecaoAjustada] 54, [OV - Item Valor Geral] 55, [OV - Subcanal] 56, [OV - PV To Date] 57, [OV - Produto Grupo Temp] 58, [OV - Chave SSS Geral] 59, [Margem - PM] 60, [Margem - Custo PÇ] 61, [Margem - Perc. CustoV] 62, [OV - Margem Liq Produto] 63, [OV - SSS Geral] 64, [OV - SSS Ponderado] 65, [OV - Produto Grupo] 66, [OV - Abertura_AnoAtual] 67, [OV - Abertura_AnoAnterior] 68, [OV - Segmento] 69, [Meta - Quantidade] 70, [Meta - Valor] 71, [Meta - Grupo de Marca] 72, [Meta - Marca] 73, [Meta - Gerente Regional] 74, [Meta - Representante] 75, [Meta - Representante - Codigo Ajustado] 76, [Meta - Gerente de Área Fidelizado] 77, [Meta - Canal] 78, [Meta - ROB Meta (Venda)] 79, [Meta - ROB Meta] 80, [Meta - Qtde. Meta (Venda)] 81, [Meta - Qtde. Meta] 82, [Meta - ROL Meta Venda] 83, [Meta - ROL Meta] 84, [Meta - Margem Bruta Meta Venda] 85, [Meta - Margem Bruta Meta] 86, [Meta - Margem Liq. Meta Venda] 87, [Meta - Margem Liq. Meta] 88, [Meta - Qtde. Aberturas] 89, [Meta - Desconto Valor] 90, [Meta - Desconto Pct] 91, [RC - Qtde Prep] 92, [RC - Qtde RC_Prep] 93, [DiasVenda - Qtde] 94, [DiasVenda - Tipo] 95, [MetaTM - TM_Pct] 96)\nFROM 'https://sadevbrdatalakemalwee.dfs.core.windows.net/raw/brazil/demo/ordemvenda/2021/02/08/ordem_venda_202102081030.csv'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIRSTROW = 2\n\t--,ERRORFILE = 'https://sadevbrdatalakemalwee.dfs.core.windows.net/raw/'\n\t,IDENTITY_INSERT = 'OFF'\n)\n--END\nGO\n\nSELECT TOP 100 * FROM dw.ordem_venda\nGO",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}