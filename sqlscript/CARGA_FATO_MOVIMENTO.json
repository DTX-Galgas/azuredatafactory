{
	"name": "CARGA_FATO_MOVIMENTO",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": "truncate table dw.FATO_MOVIMENTO\n\ninsert into dw.FATO_MOVIMENTO\nSELECT \n ISNULL(DIM_CALENDARIO.SK_DATA,19000101)\t\t\tAS SK_DATA\n,ISNULL(DIM_CLIENTE.SK_CLIENTE,1)\t\t\t\t\tAS SK_CLIENTE\n,ISNULL(DIM_LOJA.SK_LOJA,1)\t\t\t\t\t\t\tAS SK_CIGAM_LOJA\n,ISNULL(DIM_PRODUTO.SK_PRODUTO,1)\t\t\t\t\tAS SK_PRODUTO\n,ISNULL(DIM_VENDEDOR.SK_VENDEDOR,1)\t\t\t\t\tAS SK_VENDEDOR\n,[MODALIDADE_VENDA]\n,[TIPO_MOVIMENTO]\n,[NUMERO_DOCTO]\n,[VENDAS_QTD_ITEM]\n,[VENDAS_VALOR_UNITARIO]\n,[VENDAS_VALOR_TOTAL_ITEM]\n,[DEVOLUCAO_QTD_ITEM]\n,[DEVOLUCAO_VALOR_UNITARIO]\n,[DEVOLUCAO_VALOR_TOTAL_ITEM]\n FROM  [ODS].[PRE_CARGA_FATO_MOVIMENTO]\t\tAS ODS\n\t\t\tLEFT JOIN DW.DIM_CALENDARIO\t\tAS DIM_CALENDARIO       ON ODS.DATA_CONFIRMACAO = DIM_CALENDARIO.SK_DATA\n            LEFT JOIN DW.DIM_CIGAM_CLIENTE\tAS DIM_CLIENTE\t\t\tON ODS.ESTAB_IDCIGAM = DIM_CLIENTE.ESTAB_IDCIGAM AND \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tODS.CLIENTE_CODIGO = DIM_CLIENTE.CLIENTE_CODIGO\n            LEFT JOIN DW.DIM_CIGAM_LOJA\t\tAS DIM_LOJA             ON DIM_LOJA.ESTAB_IDCIGAM  = ODS.ESTAB_IDCIGAM  \n            LEFT JOIN DW.DIM_CIGAM_PRODUTO\tAS DIM_PRODUTO\t\t\tON DIM_PRODUTO.PRODUTO_REFERENCIATAM = ODS.PRODUTO_REFERENCIATAM     \n            LEFT JOIN DW.DIM_CIGAM_VENDEDOR AS DIM_VENDEDOR\t\t\tON DIM_VENDEDOR.IDLOJA_CIGAM =  ODS.ESTAB_IDCIGAM AND \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tDIM_VENDEDOR.VENDEDOR_CODIGO = ODS.VENDEDOR_CODIGO                                     \n                                         ",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}