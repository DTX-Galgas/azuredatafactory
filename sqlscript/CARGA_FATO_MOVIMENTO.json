{
	"name": "CARGA_FATO_MOVIMENTO",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": "\n\ninsert into dw.fato_cigam_movimento\nselect \n isnull(dim_calendario.sk_data,19000101)\t\t\tas sk_data\n,isnull(dim_cliente.sk_cliente,1)\t\t\t\t\tas sk_cliente\n,isnull(dim_loja.sk_loja,1)\t\t\t\t\t\t\tas sk_cigam_loja\n,isnull(dim_produto.sk_produto,1)\t\t\t\t\tas sk_produto\n,isnull(dim_vendedor.sk_vendedor,1)\t\t\t\t\tas sk_vendedor\n,upper(ods.modalidade_venda)\t\t\t\t\t\tas modalidade_venda\n,upper(ods.tipo_movimento)\t\t\t\t\t\t\tas tipo_movimento\n,ods.numero_docto\n,ods.vendas_qtd_item\n,ods.vendas_valor_unitario\n,ods.vendas_valor_total_item\n,ods.devolucao_qtd_item\n,ods.devolucao_valor_unitario\n,ods.devolucao_valor_total_item\n from  ods.pre_carga_fato_movimento\t\tas ods\n\t\t\tleft join dw.dim_calendario\t\tas dim_calendario       on ods.data_confirmacao = dim_calendario.sk_data\n            left join dw.dim_cigam_cliente\tas dim_cliente\t\t\ton ods.estab_idcigam = dim_cliente.estab_idcigam and \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tods.cliente_codigo = dim_cliente.cliente_codigo\n            left join dw.dim_cigam_loja\t\tas dim_loja             on dim_loja.estab_idcigam  = ods.estab_idcigam  \n            left join dw.dim_cigam_produto\tas dim_produto\t\t\ton dim_produto.produto_referenciatam = ods.produto_referenciatam     \n            left join dw.dim_cigam_vendedor as dim_vendedor\t\t\ton dim_vendedor.idloja_cigam =  ods.estab_idcigam and \n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdim_vendedor.vendedor_codigo = ods.vendedor_codigo                                     \n                                         ",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}