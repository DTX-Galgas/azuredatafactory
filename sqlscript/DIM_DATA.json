{
	"name": "DIM_DATA",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": "declare @datainicio as date\nset @datainicio = '1850-01-01'\n\n\nwhile @datainicio <= convert(date,'2050-12-31')\nbegin \ninsert into dw.DimCalendario\nselect \nreplace(CONVERT(varchar(10),@datainicio),'-','')as IdData\n,DATEPART(year,@datainicio) as Ano\n,case\nwhen LEN(DATEPART(MONTH,@datainicio)) = 1 then \nCONVERT(varchar,DATEPART(year,@datainicio)) + '0' + CONVERT(varchar,DATEPART(MONTH,@datainicio))\nelse \nCONVERT(varchar,DATEPART(year,@datainicio))  + CONVERT(varchar,DATEPART(MONTH,@datainicio))\nend  as AnoMes\n,replace(CONVERT(varchar(10),@datainicio),'-','')as AnoMesDia\n,@datainicio as Data\n,DATEPART(day,@datainicio)as Dia\n,case\n\twhen DATEPART(MONTH,@datainicio) = 1 then 'Janeiro'\n\twhen DATEPART(MONTH,@datainicio) = 2 then 'Fevereiro'\n\twhen DATEPART(MONTH,@datainicio) = 3 then 'Março'\n\twhen DATEPART(MONTH,@datainicio) = 4 then 'Abril'\n\twhen DATEPART(MONTH,@datainicio) = 5 then 'Maio'\n\twhen DATEPART(MONTH,@datainicio) = 6 then 'junho'\n\twhen DATEPART(MONTH,@datainicio) = 7 then 'Julho'\n\twhen DATEPART(MONTH,@datainicio) = 8 then 'Agosto'\n\twhen DATEPART(MONTH,@datainicio) = 9 then 'Setembro'\n\twhen DATEPART(MONTH,@datainicio) = 10 then 'Outubro'\n\twhen DATEPART(MONTH,@datainicio) = 11 then 'Novembro'\n\twhen DATEPART(MONTH,@datainicio) = 12 then 'Dezembro'\nend as Mes\n,case\n\twhen DATEPART(MONTH,@datainicio) = 1  then 'Jan/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 2  then 'Fev/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 3  then 'Mar/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 4  then 'Abr/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 5  then 'Mai/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 6  then 'jun/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 7  then 'Jul/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 8  then 'Ago/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 9  then 'Set/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 10 then 'Out/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 11 then 'Nov/' + CONVERT(varchar,DATEPART(year,@datainicio)) \n\twhen DATEPART(MONTH,@datainicio) = 12 then 'Dez/' + CONVERT(varchar,DATEPART(year,@datainicio)) \nend as MesAnoDesc\n,DATEPART(MONTH,@datainicio)as MumeroMes\n,DATEPART(DW,@datainicio)as NumeroDiaDaSemana\n,case\n\twhen DATEPART(DW,@datainicio) = 1 then 'Domingo'\n\twhen DATEPART(DW,@datainicio) = 2 then 'Segunda-Feira'\n\twhen DATEPART(DW,@datainicio) = 3 then 'Terça-Feira'\n\twhen DATEPART(DW,@datainicio) = 4 then 'Quarta-Feira'\n\twhen DATEPART(DW,@datainicio) = 5 then 'Quinta-Feira'\n\twhen DATEPART(DW,@datainicio) = 6 then 'Sexta-Feira'\n\twhen DATEPART(DW,@datainicio) = 7 then 'Sábado'\nend as DiaSemana\n,DATEPART(dy,@datainicio) as DiaDoAno\n,DATEPART(week,@datainicio) as SemanadoAno\n,case\n\twhen DATEPART(MONTH,@datainicio) in (1,2,3) then 'Q1'\n\twhen DATEPART(MONTH,@datainicio) in (4,5,6) then 'Q2'\n\twhen DATEPART(MONTH,@datainicio) in (7,8,9) then 'Q3'\n\twhen DATEPART(MONTH,@datainicio) in (10,11,12)then 'Q4'\nend AS Trimestre\n,case\n\twhen DATEPART(MONTH,@datainicio) in (1,2,3) then 1\n\twhen DATEPART(MONTH,@datainicio) in (4,5,6) then 2\n\twhen DATEPART(MONTH,@datainicio) in (7,8,9) then 3\n\twhen DATEPART(MONTH,@datainicio) in (10,11,12)then 4\nend AS NumeroTrimestre\n,case\n\twhen DATEPART(MONTH,@datainicio) in (1,2,3,4,5,6) then 'S1'\n\twhen DATEPART(MONTH,@datainicio) in (7,8,9,10,11,12)then 'S2'\nend AS Semestre\n,case\n\twhen DATEPART(MONTH,@datainicio) in (1,2,3,4,5,6) then 1\n\twhen DATEPART(MONTH,@datainicio) in (7,8,9,10,11,12)then 2\nend AS NumeroSemestre\n\nset @datainicio = DATEADD(d,1,@datainicio)\n\nend \n\n\n ",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}