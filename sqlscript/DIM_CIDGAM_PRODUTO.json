{
	"name": "DIM_CIDGAM_PRODUTO",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": "INSERT INTO DW.DIM_CIGAM_PRODUTO\nSELECT  \nCONVERT(VARCHAR(10),PRODUTO_MODELO)                                                                         AS PRODUTO_MODELO\n,UPPER(CONVERT(VARCHAR(100),ISNULL(PRODUTO_DESCRICAO,'NÃO INFORMADO')))                                     AS PRODUTO_DESCRICAO\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_COLECAO,'NÃO INFORMADO')))                                        AS PRODUTO_COLECAO\n,CONVERT(INT,ISNULL(PRODUTO_SUBCOLECAO,-1))                                                                 AS PRODUTO_SUBCOLECAO\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_LINHA,'NÃO INFORMADO')))                                          AS PRODUTO_LINHA\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_ARTIGO,'NÃO INFORMADO')))                                         AS PRODUTO_ARTIGO\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_COMPL_ARTIGO,'NÃO INFORMADO')))                                   AS PRODUTO_COMPL_ARTIGO\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_COR,'NÃO INFORMADO')))                                            AS PRODUTO_COR\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_COR_FRANQUEADORA,'NÃO INFORMADO')))                               AS PRODUTO_COR_FRANQUEADORA\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_GENERO,'NÃO INFORMADO')))                                         AS PRODUTO_GENERO\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_MARCA,'NÃO INFORMADO')))                                          AS PRODUTO_MARCA\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_GRUPOALVO,'NÃO INFORMADO')))                                      AS PRODUTO_GRUPOALVO\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_MATERIAL,'NÃO INFORMADO')))                                       AS PRODUTO_MATERIAL\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_EAN,'NÃO INFORMADO')))                                            AS PRODUTO_EAN\n,UPPER(CONVERT(VARCHAR(50),'NÃO INFORMADO'))                                                                AS VENDAS_EAN\n,UPPER(CONVERT(VARCHAR(50),ISNULL(PRODUTO_TAMANHO,'NÃO INFORMADO')))                                        AS PRODUTO_TAMANHO\n,CASE\n    WHEN PRODUTO_ATIVO IS NULL OR LEN(PRODUTO_ATIVO) =  0 OR PRODUTO_ATIVO NOT IN ('S','N') THEN 'NÃO INFORMADO'\n    WHEN PRODUTO_ATIVO = 'S'     THEN 'SIM'\n    WHEN PRODUTO_ATIVO = 'N'     THEN 'NÃO'\nEND PRODUTO_ATIVO\nFROM CLEANSING_DATA.GST_BI_PRODUTOS\n\n\nUPDATE PRODUTO\nSET PRODUTO.VENDAS_EAN = VENDAS.CODIGO_BARRAS\nFROM DW.DIM_CIGAM_PRODUTO PRODUTO\nINNER JOIN cleansing_data.GST_BI_VENDAS  VENDAS\non  PRODUTO.PRODUTO_MODELO  = CONVERT(VARCHAR(10),VENDAS.PRODUTO )  \n\n\n  \n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}