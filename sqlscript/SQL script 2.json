{
	"name": "SQL script 2",
	"properties": {
		"content": {
			"query": " select top(1000) \n convert(date,DATA_CONFIRMACAO) as DATA_CONFIRMACAO\n ,Vendas.IDLOJA_CIGAM\n ,Loja.* \n ,Vendas.NUMERO_DOCTO\n ,Vendas.CLIENTE_CODIGO\n ,Cliente.*\n ,Vendas.VENDEDOR_CODIGO\n ,Vendas.VENDEDOR_NOME\n ,Vendas.MODALIDADE_VENDA\n ,Vendas.TIPO_MOVIMENTO\n ,Vendas.PRODUTO\n ,Produto.*\n ,Vendas.CODIGO_BARRAS  \n ,Vendas.QTD_ITEM\n ,Vendas.VALOR_UNITARIO\n ,Vendas.VALOR_TOTAL_ITEM\n from cleansing_data.GST_BI_VENDAS  as Vendas\n left join cleansing_data.gst_bi_estabelecimento as Loja on Vendas.IDLOJA_CIGAM = Loja.estab_idcigam\n left join cleansing_data.gst_bi_produtos as Produto on Vendas.PRODUTO =  Produto.Produto_modelo \n left join cleansing_data.gst_bi_clientes as Cliente on \n           Vendas.IDLOJA_CIGAM = Cliente.estab_idcigam and \n           Vendas.CLIENTE_CODIGO = Cliente.CLIENTE_CODIGO\n           where Cliente.CLIENTE_CODIGO is not null and\n            Vendas.IDLOJA_CIGAM = 'W031' and\n            Vendas.NUMERO_DOCTO = '17033'\n\n\n/** loja **/\nselect  TOP(10) \nCONVERT(VARCHAR(5),ESTAB_IDCIGAM)                                                                       AS  ESTAB_IDCIGAM\n,CONVERT(VARCHAR(15),UPPER(ISNULL(ESTAB_TIPOFILIAL,'NÃO INFORMADO')))                                   AS  ESTAB_TIPOFILIAL\n,CONVERT(INT,ISNULL(ESTAB_IDINTEGRACAO,-1))                                                             AS  ESTAB_IDINTEGRACAO\n,CONVERT(VARCHAR(15), UPPER(ISNULL(ESTAB_TIPOFILIAL,'NÃOINFORMADO')))                                   AS  ESTAB_TIPOFILIAL\n,CONVERT(VARCHAR(150), UPPER(ISNULL(ESTAB_NOME,'NÃO INFORMADO')))                                       AS  ESTAB_NOME\n,CONVERT(FLOAT, ISNULL(ESTAB_AREA,-1))                                                                  AS  ESTAB_AREA\n,CONVERT(VARCHAR(20), UPPER(ISNULL(REGIAO_DESCRICAO,'NÃOINFORMADO')))                                   AS  REGIAO_DESCRICAO\n,CONVERT(VARCHAR(15), UPPER(ISNULL(ESTAB_ESTADO,'NÃO INFROAMDO')))                                      AS  ESTAB_ESTADO\n,CONVERT(VARCHAR(15), UPPER(ISNULL(CONSULTOR_NUMMATR,'NÃO INFORMADO')))                                 AS  CONSULTOR_NUMMATR\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CONSULTOR_NOME,'NÃO INFORMADO')))                                    AS  CONSULTOR_NOME\n,CONVERT(VARCHAR(15),UPPER(ISNULL(ESTAB_ATIVO,'NÃO IFORMADO')))                                         AS  ESTAB_ATIVO\n,CONVERT(VARCHAR(150),UPPER(ISNULL(ESTAB_RAZAO_SOCIAL,'NÃO INFORMADO')))                                AS  ESTAB_RAZAO_SOCIAL\n,CONVERT(VARCHAR(150),UPPER(ISNULL(ESTAB_ENDERECO,'NÃO INFORMADO')))                                    AS  ESTAB_ENDERECO\n,CONVERT(VARCHAR(15),ISNULL(ESTAB_ENDNUMERO,'NÃO INFORMADO'))                                           AS  ESTAB_ENDNUMERO\n,CONVERT(VARCHAR(150),UPPER(ISNULL(ESTAB_BAIRRO,'NÃO INFORMADO')))                                      AS  ESTAB_BAIRRO\n,CONVERT(VARCHAR(15),ISNULL(ESTAB_CEP,'NAO INFORMADO'))                                                 AS  ESTAB_CEP\n,CONVERT(VARCHAR(150),UPPER(ISNULL(ESTAB_CIDADE,'NÃO INFORMADO')))                                      AS  ESTAB_CIDADE\n,CONVERT(VARCHAR(150),UPPER(ISNULL(ESTAB_EMAIL,'NÃO INFORMADO')))                                       AS  ESTAB_EMAIL\n,CONVERT(int,ISNULL(ESTAB_DDD,-1))                                                                      AS  ESTAB_DDD\n,CONVERT(int,ISNULL(ESTAB_TELEFONE,-1))                                                                 AS  ESTAB_TELEFONE\n,CONVERT(DATE,ISNULL(ESTAB_DATA_INICIOOPER,'1900-01-01'))                                               AS  ESTAB_DATA_INICIOOPER\n,CONVERT(VARCHAR(150),UPPER(ISNULL(SHOPPING_NOME,'NÃO INFORMADO')))                                     AS  SHOPPING_NOME\n,CONVERT(VARCHAR(150),UPPER(ISNULL(SHOPPING_NOME,'NÃO INFORMADO')))                                     AS  SHOPPING_NOME\n,CONVERT(VARCHAR(150),UPPER(ISNULL(SHOPPING_NOME,'NÃO INFORMADO')))                                     AS  SHOPPING_NOME\n\n,\n,FRANQUEADO_EMAIL\n,ESTAB_CNPJ\n,ESTAB_PERFIL\n,REDELOJA_CODIGO\n,REDELOJA_NOME\n--,TIPO_NEGOCIO\nfrom cleansing_data.gst_bi_estabelecimento\n\n\nSELECT MAX(LEN(ESTAB_CEP)) FROM cleansing_data.gst_bi_estabelecimento\nWHERE LEN(ESTAB_NOME) = 0 OR ESTAB_NOME IS NULL \n\n\n\n\n\n  \n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}