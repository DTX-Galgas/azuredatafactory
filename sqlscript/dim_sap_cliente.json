{
	"name": "dim_sap_cliente",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL/sap"
		},
		"content": {
			"query": "select \nkna1.kunnr\t\t\t\t\t\t\t\t\t\t\t\tas PK_CLIENTE\n,kna1.kunnr\t\t\t\t\t\t\t\t\t\t\t\tas CODIGO_CLIENTE\n,UPPER(kna1.name1)\t\t\t\t\t\t\t\t\t\tas NOME_CLIENTE   \n,UPPER(kna1.name1) +' - ' +convert(varchar,convert(int,kunnr))\tas CODIGO_NOME_CLIENTE\n,UPPER(kna1.anred)\t\t\t\t\t\t\t\t\t\t\t\tas TIPO_CLIENTE       --TIPO_CLIENTE   Tipo_Cliente  TipoCliente  Cliente_Tipo Tipo      Cliente - Tipo,\n,kna1.pstlz\t\t\t\t\t\t\t\t\t\t\t\tas CEP_CLIENTE\n,kna1.stcd1\t\t\t\t\t\t\t\t\t\t\t\tas CPNJ_CLIENTE\n,substring(kna1.stcd1,1,18)                             as CNPJ_RAIZ_CLIENTE\n,CASE WHEN LEN(kna1.stcd2)=0  OR kna1.stcd2 IS NULL THEN '0' ELSE kna1.stcd2 END \t\t\t\t\t\t\t\t\t\t\t\tas CPF_CLIENTE\n--,iif(len(trim(kna1.stcd1)) >1, kna1.stcd1, kna1.stcd2)  \n,case\nwhen len(trim(kna1.stcd1)) > 1 then kna1.stcd1\nelse kna1.stcd2\nend\t\t\t\t\t\t\t\t\t\t\t\t\t\tas CPF_CNPJ_CLIENTE\n--,iif(len(kna1.aufsd)>=1,'inativo','ativo')\t\t\tas clienteativo         ATIVO_INATIVO_CLIENTE\n,case\nwhen len(kna1.aufsd)>=1 then 'INATIVO'\nelse 'ATIVO'\nend\t\t\t\t\t\t\t\t\t\t\t\t\t\tas CLIENTE_ATIVO\n,convert(date,kna1.erdat)\t\t\t\t\t\t\t\tas DATA_CRIACAO_CLIENTE\n--, kna1.erdat\t\t\t\t\t\t\t\t\t\t\tas clientedatacriacao  \n,kna1.land1\t\t\t\t\t\t\t\t\t\t\t\tas PAIS_CLIENTE\n--,iif(kna1.land1 = 'br','interno','externo' )\t\t\tas clientemercado      MERCADO_CLIENTE\n,case\nwhen kna1.land1 = 'br' then 'INTERNO'\nelse 'EXTERNO'\nend\t\t\t\t\t\t\t\t\t\t\t\t\t\tas CLIENTE_MERCADO\n,kna1.ort02\t\t\t\t\t\t\t\t\t\t\t\tas BAIRRO_CLIENTE\n,kna1.ort01\t\t\t\t\t\t\t\t\t\t\t\tas CIDADE_CLIENTE\n,case\nWHEN REGIO =  'AC' THEN 'NORTE'\nWHEN REGIO =  'AL' THEN 'NORDESTE'\nWHEN REGIO =  'AP' THEN 'NORTE'\nWHEN REGIO =  'AM' THEN 'NORTE'\nWHEN REGIO =  'BA' THEN 'NORDESTE'\nWHEN REGIO =  'CE' THEN 'NORDESTE'\nWHEN REGIO =  'DF' THEN 'CENTRO OESTE'\nWHEN REGIO =  'ES' THEN 'SUDESTE'\nWHEN REGIO =  'GO' THEN 'CENTRO OESTE'\nWHEN REGIO =  'MA' THEN 'NORDESTE'\nWHEN REGIO =  'MT' THEN 'CENTRO OESTE'\nWHEN REGIO =  'MS' THEN 'CENTRO OESTE'\nWHEN REGIO =  'MG' THEN 'SUDESTE'\nWHEN REGIO =  'PA' THEN 'NORTE'\nWHEN REGIO =  'PB' THEN 'NORDESTE'\nWHEN REGIO =  'PR' THEN 'SUL'\nWHEN REGIO =  'PE' THEN 'NORDESTE'\nWHEN REGIO =  'PI' THEN 'NORDESTE'\nWHEN REGIO =  'RJ' THEN 'SUDESTE'\nWHEN REGIO =  'RN' THEN 'NORDESTE'\nWHEN REGIO =  'RS' THEN 'SUL'\nWHEN REGIO =  'RO' THEN 'NORTE'\nWHEN REGIO =  'RR' THEN 'NORTE'\nWHEN REGIO =  'SC' THEN 'SUL'\nWHEN REGIO =  'SP' THEN 'SUDESTE'\nWHEN REGIO =  'SE' THEN 'NORDESTE'\nWHEN REGIO =  'TO' THEN 'NORTE'\nELSE 'NÃO INFORMADO'\nend\t\t\t\t\t\t\t\t\t\t\t\t\t\tas REGIAO_CLIENTE\n,kna1.regio\t\t\t\t\t\t\t\t\t\t\t\tas UF_CLIENTE\n,kna1.ort01 + ' - ' + regio\t\t\t\t\t\t\t\tas MUN_UF_CLIENTE\n,CASE WHEN LEN(kna1.konzs) = 0 OR kna1.konzs IS NULL THEN 'NÃO INFORMADO' ELSE kna1.konzs  END \t\t\t\t\t\t\t\t\t\t\t\tas GRUPO_EMPRESA_CLIENTE\nINTO DW.SAP_DIM_CLIENTE\nfrom cleansing_data.sap_kna1  as kna1\nleft join cleansing_data.sap_ausp as ausp on ausp.objek = kna1.kunnr\nwhere kna1.erdat != '00000000'\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "Built-in",
				"databaseName": "master"
			}
		},
		"type": "SqlQuery"
	}
}