{
	"name": "Demo Produto",
	"properties": {
		"content": {
			"query": "SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nDECLARE @SEPARATOR VARCHAR(30) = '     //     '\nDECLARE @COUNT_BEFORE BIGINT\nSELECT @COUNT_BEFORE = COUNT(*) FROM dw.produto\nPRINT @SEPARATOR + 'INÍCIO: ' + CAST(@COUNT_BEFORE AS VARCHAR(30)) + ' PRODUTOS'\n\n\nPRINT 'Create tmp_produto'\nCREATE TABLE [dw].[tmp_produto]\n( \n\t[pk_material] [bigint]  NULL,\n\t[Código] [bigint]  NULL,\n\t[Descrição] [nvarchar](3000)  NULL,\n\t[Descrição-Código] [nvarchar](3000)  NULL,\n\t[Linha Produto] [nvarchar](30)  NULL,\n\t[Destino Confecção] [nvarchar](30)  NULL,\n\t[Categoria] [nvarchar](30)  NULL,\n\t[Básico/Moda] [nvarchar](30)  NULL,\n\t[Espécie] [nvarchar](30)  NULL,\n\t[Espécie Detalhada] [nvarchar](30)  NULL,\n\t[Categoria Linha] [nvarchar](30)  NULL,\n\t[Ocasião] [nvarchar](30)  NULL,\n\t[Genero] [nvarchar](30)  NULL,\n\t[Segmento] [nvarchar](30)  NULL,\n\t[Marca] [nvarchar](30)  NULL,\n\t[Empresa Licenciado] [nvarchar](30)  NULL,\n\t[MateriaPrima] [nvarchar](30)  NULL,\n\t[Personagem Licenciado] [nvarchar](30)  NULL,\n\t[SubLinha] [nvarchar](30)  NULL,\n\t[Grade] [nvarchar](30)  NULL,\n\t[Permanência] [nvarchar](30)  NULL,\n\t[Qualidade] [nvarchar](30)  NULL,\n\t[Tipo Mascara] [nvarchar](30)  NULL,\n\t[Metros Kilo] [nvarchar](30)  NULL,\n\t[Embalagem] [nvarchar](30)  NULL,\n\t[Ultima Estação] [nvarchar](30)  NULL,\n\t[Ultima Coleção] [nvarchar](30)  NULL,\n\t[Modelo Capsula] [nvarchar](30)  NULL,\n\t[Hierarquia Descrição] [nvarchar](3000)  NULL,\n\t[URL Foto] [nvarchar](3000)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\n\n\nPRINT @SEPARATOR + 'Copy csv to tmp_produto'\nCOPY INTO dw.tmp_produto\n(pk_material 1, Código 2, Descrição 3, [Descrição-Código] 4, [Linha Produto] 5, [Destino Confecção] 6, Categoria 7, [Básico/Moda] 8, Espécie 9, [Espécie Detalhada] 10, [Categoria Linha] 11, Ocasião 12, Genero 13, Segmento 14, Marca 15, [Empresa Licenciado] 16, MateriaPrima 17, [Personagem Licenciado] 18, SubLinha 19, Grade 20, Permanência 21, Qualidade 22, [Tipo Mascara] 23, [Metros Kilo] 24, Embalagem 25, [Ultima Estação] 26, [Ultima Coleção] 27, [Modelo Capsula] 28, [Hierarquia Descrição] 29, [URL Foto] 30)\nFROM 'https://sadevbrdatalakemalwee.dfs.core.windows.net/raw/brazil/demo/Produto.csv'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIRSTROW = 2\n\t,ERRORFILE = 'https://sadevbrdatalakemalwee.dfs.core.windows.net/raw/brazil/demo/errors'\n\t,IDENTITY_INSERT = 'OFF'\n)\n\n\nPRINT @SEPARATOR + 'Drop produto'\nDROP TABLE [dw].[produto]\n\n\nPRINT @SEPARATOR + 'Create produto'\nCREATE TABLE [dw].[produto]\n( \n\t[pk_material] [bigint]  NOT NULL,\n\t[Produto - Código] [bigint]  NULL,\n\t[Produto - Descrição] [nvarchar](3000)  NULL,\n\t[Produto - Descrição-Código] [nvarchar](3000)  NULL,\n\t[Produto - Linha Produto] [nvarchar](30)  NULL,\n\t[Produto - Destino Confecção] [nvarchar](30)  NULL,\n\t[Produto - Categoria] [nvarchar](30)  NULL,\n\t[Produto - Básico/Moda] [nvarchar](30)  NULL,\n\t[Produto - Espécie] [nvarchar](30)  NULL,\n\t[Produto - Espécie Detalhada] [nvarchar](30)  NULL,\n\t[Produto - Categoria Linha] [nvarchar](30)  NULL,\n\t[Produto - Ocasião] [nvarchar](30)  NULL,\n\t[Produto - Genero] [nvarchar](30)  NULL,\n\t[Produto - Segmento] [nvarchar](30)  NULL,\n\t[Produto - Marca] [nvarchar](30)  NULL,\n\t[Produto - Empresa Licenciado] [nvarchar](30)  NULL,\n\t[Produto - MateriaPrima] [nvarchar](30)  NULL,\n\t[Produto - Personagem Licenciado] [nvarchar](30)  NULL,\n\t[Produto - SubLinha] [nvarchar](30)  NULL,\n\t[Produto - Grade] [nvarchar](30)  NULL,\n\t[Produto - Permanência] [nvarchar](30)  NULL,\n\t[Produto - Qualidade] [nvarchar](30)  NULL,\n\t[Produto - Tipo Mascara] [nvarchar](30)  NULL,\n\t[Produto - Metros Kilo] [decimal](19,4)  NULL,\n\t[Produto - Embalagem] [nvarchar](30)  NULL,\n\t[Produto - Ultima Estação] [nvarchar](30)  NULL,\n\t[Produto - Ultima Coleção] [nvarchar](30)  NULL,\n\t[Produto - Modelo Capsula] [nvarchar](30)  NULL,\n\t[Produto - Hierarquia Descrição] [nvarchar](3000)  NULL,\n\t[Produto - URL Foto] [nvarchar](3000)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\n\n\nPRINT @SEPARATOR + 'Insert tmp to produto'\ninsert into dw.produto (\n\t\t[pk_material],\n\t\t[Produto - Código],\n\t\t[Produto - Descrição],\n\t\t[Produto - Descrição-Código],\n\t\t[Produto - Linha Produto],\n\t\t[Produto - Destino Confecção],\n\t\t[Produto - Categoria],\n\t\t[Produto - Básico/Moda],\n\t\t[Produto - Espécie],\n\t\t[Produto - Espécie Detalhada],\n\t\t[Produto - Categoria Linha],\n\t\t[Produto - Ocasião],\n\t\t[Produto - Genero],\n\t\t[Produto - Segmento],\n\t\t[Produto - Marca],\n\t\t[Produto - Empresa Licenciado],\n\t\t[Produto - MateriaPrima],\n\t\t[Produto - Personagem Licenciado],\n\t\t[Produto - SubLinha],\n\t\t[Produto - Grade],\n\t\t[Produto - Permanência],\n\t\t[Produto - Qualidade],\n\t\t[Produto - Tipo Mascara],\n\t\t[Produto - Metros Kilo],\n\t\t[Produto - Embalagem],\n\t\t[Produto - Ultima Estação],\n\t\t[Produto - Ultima Coleção],\n\t\t[Produto - Modelo Capsula],\n\t\t[Produto - Hierarquia Descrição],\n\t\t[Produto - URL Foto]\n\t)\nselect pk_material,\n\tCódigo,\n\tDescrição,\n\t[Descrição-Código],\n\t[Linha Produto],\n\t[Destino Confecção],\n\tCategoria,\n\t[Básico/Moda],\n\tEspécie,\n\t[Espécie Detalhada],\n\t[Categoria Linha],\n\tOcasião,\n\tGenero,\n\tSegmento,\n\tMarca,\n\t[Empresa Licenciado],\n\tMateriaPrima,\n\t[Personagem Licenciado],\n\tSubLinha,\n\tGrade,\n\tPermanência,\n\tQualidade,\n\t[Tipo Mascara],\n\tREPLACE([Metros Kilo], ',', '.') as [Metros Kilo],\n\tEmbalagem,\n\t[Ultima Estação],\n\t[Ultima Coleção],\n\t[Modelo Capsula],\n\t[Hierarquia Descrição],\n\t[URL Foto]\nfrom dw.tmp_produto\n\n\nPRINT @SEPARATOR + 'Drop tmp_produto'\nDROP TABLE [dw].[tmp_produto]\n\n\nDECLARE @COUNT_AFTER BIGINT\nSELECT @COUNT_AFTER = COUNT(*) FROM dw.produto\nSELECT 'IMPORTAÇÃO REALIZADA', GETDATE() AS DT_FINALIZADO, @COUNT_AFTER AS COUNT_AFTER, MAX([pk_material]) AS MAX_PK_MATERIAL FROM dw.produto\nPRINT @SEPARATOR + 'FIM: ' + CAST(@COUNT_AFTER AS VARCHAR(30)) + ' PRODUTOS'\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}