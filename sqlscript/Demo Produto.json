{
	"name": "Demo Produto",
	"properties": {
		"content": {
			"query": "SET ANSI_NULLS ON\nGO\nSET QUOTED_IDENTIFIER ON\nGO\n\n\nDECLARE @SEPARATOR VARCHAR(30) = '     //     '\nDECLARE @COUNT_BEFORE BIGINT\nSELECT @COUNT_BEFORE = COUNT(*) FROM dw.produto\nPRINT @SEPARATOR + 'INÍCIO: ' + CAST(@COUNT_BEFORE AS VARCHAR(30)) + ' PRODUTOS'\n\n\nPRINT 'Create tmp_produto'\nCREATE TABLE [dw].[tmp_produto]\n( \n\t[pk_material] [bigint]  NULL,\n\t[Código] [bigint]  NULL,\n\t[Descrição] [nvarchar](3000)  NULL,\n\t[Descrição-Código] [nvarchar](3000)  NULL,\n\t[Linha Produto] [nvarchar](30)  NULL,\n\t[Destino Confecção] [nvarchar](30)  NULL,\n\t[Categoria] [nvarchar](30)  NULL,\n\t[Básico/Moda] [nvarchar](30)  NULL,\n\t[Espécie] [nvarchar](30)  NULL,\n\t[Espécie Detalhada] [nvarchar](30)  NULL,\n\t[Categoria Linha] [nvarchar](30)  NULL,\n\t[Ocasião] [nvarchar](30)  NULL,\n\t[Genero] [nvarchar](30)  NULL,\n\t[Segmento] [nvarchar](30)  NULL,\n\t[Marca] [nvarchar](30)  NULL,\n\t[Empresa Licenciado] [nvarchar](30)  NULL,\n\t[MateriaPrima] [nvarchar](30)  NULL,\n\t[Personagem Licenciado] [nvarchar](30)  NULL,\n\t[SubLinha] [nvarchar](30)  NULL,\n\t[Grade] [nvarchar](30)  NULL,\n\t[Permanência] [nvarchar](30)  NULL,\n\t[Qualidade] [nvarchar](30)  NULL,\n\t[Tipo Mascara] [nvarchar](30)  NULL,\n\t[Metros Kilo] [nvarchar](30)  NULL,\n\t[Embalagem] [nvarchar](30)  NULL,\n\t[Ultima Estação] [nvarchar](30)  NULL,\n\t[Ultima Coleção] [nvarchar](30)  NULL,\n\t[Modelo Capsula] [nvarchar](30)  NULL,\n\t[Hierarquia Descrição] [nvarchar](3000)  NULL,\n\t[URL Foto] [nvarchar](3000)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\n\n\nPRINT @SEPARATOR + 'Copy csv to tmp_produto'\nCOPY INTO dw.tmp_produto\n(pk_material 1, Código 2, Descrição 3, [Descrição-Código] 4, [Linha Produto] 5, [Destino Confecção] 6, Categoria 7, [Básico/Moda] 8, Espécie 9, [Espécie Detalhada] 10, [Categoria Linha] 11, Ocasião 12, Genero 13, Segmento 14, Marca 15, [Empresa Licenciado] 16, MateriaPrima 17, [Personagem Licenciado] 18, SubLinha 19, Grade 20, Permanência 21, Qualidade 22, [Tipo Mascara] 23, [Metros Kilo] 24, Embalagem 25, [Ultima Estação] 26, [Ultima Coleção] 27, [Modelo Capsula] 28, [Hierarquia Descrição] 29, [URL Foto] 30)\nFROM 'https://sadevbrdatalakemalwee.dfs.core.windows.net/raw/brazil/demo/Produto.csv'\nWITH\n(\n\tFILE_TYPE = 'CSV'\n\t,MAXERRORS = 0\n\t,FIRSTROW = 2\n\t,ERRORFILE = 'https://sadevbrdatalakemalwee.dfs.core.windows.net/raw/brazil/demo/errors'\n\t,IDENTITY_INSERT = 'OFF'\n)\n\n\nPRINT @SEPARATOR + 'Drop produto'\nDROP TABLE [dw].[produto]\n\n\nPRINT @SEPARATOR + 'Create produto'\nCREATE TABLE [dw].[produto]\n( \n\t[pk_material] [bigint]  NOT NULL,\n\t[Código] [bigint]  NULL,\n\t[Descrição] [nvarchar](3000)  NULL,\n\t[Descrição-Código] [nvarchar](3000)  NULL,\n\t[Linha Produto] [nvarchar](30)  NULL,\n\t[Destino Confecção] [nvarchar](30)  NULL,\n\t[Categoria] [nvarchar](30)  NULL,\n\t[Básico/Moda] [nvarchar](30)  NULL,\n\t[Espécie] [nvarchar](30)  NULL,\n\t[Espécie Detalhada] [nvarchar](30)  NULL,\n\t[Categoria Linha] [nvarchar](30)  NULL,\n\t[Ocasião] [nvarchar](30)  NULL,\n\t[Genero] [nvarchar](30)  NULL,\n\t[Segmento] [nvarchar](30)  NULL,\n\t[Marca] [nvarchar](30)  NULL,\n\t[Empresa Licenciado] [nvarchar](30)  NULL,\n\t[MateriaPrima] [nvarchar](30)  NULL,\n\t[Personagem Licenciado] [nvarchar](30)  NULL,\n\t[SubLinha] [nvarchar](30)  NULL,\n\t[Grade] [nvarchar](30)  NULL,\n\t[Permanência] [nvarchar](30)  NULL,\n\t[Qualidade] [nvarchar](30)  NULL,\n\t[Tipo Mascara] [nvarchar](30)  NULL,\n\t[Metros Kilo] [decimal](19,4)  NULL,\n\t[Embalagem] [nvarchar](30)  NULL,\n\t[Ultima Estação] [nvarchar](30)  NULL,\n\t[Ultima Coleção] [nvarchar](30)  NULL,\n\t[Modelo Capsula] [nvarchar](30)  NULL,\n\t[Hierarquia Descrição] [nvarchar](3000)  NULL,\n\t[URL Foto] [nvarchar](3000)  NULL\n)\nWITH\n(\n\tDISTRIBUTION = ROUND_ROBIN,\n\tCLUSTERED COLUMNSTORE INDEX\n)\n\n\nPRINT @SEPARATOR + 'Insert tmp to produto'\ninsert into dw.produto (pk_material, Código, Descrição, [Descrição-Código], [Linha Produto], [Destino Confecção], Categoria, [Básico/Moda], Espécie, [Espécie Detalhada], [Categoria Linha], Ocasião, Genero, Segmento, Marca, [Empresa Licenciado], MateriaPrima, [Personagem Licenciado], SubLinha, Grade, Permanência, Qualidade, [Tipo Mascara], [Metros Kilo], Embalagem, [Ultima Estação], [Ultima Coleção], [Modelo Capsula], [Hierarquia Descrição], [URL Foto])\nselect pk_material, Código, Descrição, [Descrição-Código], [Linha Produto], [Destino Confecção], Categoria, [Básico/Moda], Espécie, [Espécie Detalhada], [Categoria Linha], Ocasião, Genero, Segmento, Marca, [Empresa Licenciado], MateriaPrima, [Personagem Licenciado], SubLinha, Grade, Permanência, Qualidade, [Tipo Mascara],\n\tREPLACE([Metros Kilo], ',', '.') as [Metros Kilo],\n\tEmbalagem, [Ultima Estação], [Ultima Coleção], [Modelo Capsula], [Hierarquia Descrição], [URL Foto]\nfrom dw.tmp_produto\n\n\nPRINT @SEPARATOR + 'Drop tmp_produto'\nDROP TABLE [dw].[tmp_produto]\n\n\nDECLARE @COUNT_AFTER BIGINT\nSELECT @COUNT_AFTER = COUNT(*) FROM dw.produto\nSELECT 'IMPORTAÇÃO REALIZADA', GETDATE() AS DT_FINALIZADO, @COUNT_AFTER AS COUNT_AFTER, MAX([pk_material]) AS MAX_PK_MATERIAL FROM dw.produto\nPRINT @SEPARATOR + 'FIM: ' + CAST(@COUNT_AFTER AS VARCHAR(30)) + ' PRODUTOS'\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}