{
	"name": "DIM_CIGAM_CLIENTE",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": "INSERT INTO DW.DIM_CIGAM_CLIENTE\nSELECT  \nCONVERT(VARCHAR(15), UPPER(ISNULL(PK_CLIENTE,'NÃOINFORMADO')))                                          AS  ID_CLIENTE\n,CONVERT(VARCHAR(5), UPPER(ISNULL(ESTAB_IDCIGAM,'NÃOINFORMADO')))                                       AS  ESTAB_IDCIGAM\n,CONVERT(INT,ISNULL(CLIENTE_CODIGO,-1))                                                                 AS  CLIENTE_CODIGO\n,CONVERT(VARCHAR(150), UPPER(ISNULL(CLIENTE_NOME,'NÃO INFORMADO')))                                     AS  CLIENTE_NOME\n,CONVERT(VARCHAR(15), UPPER(ISNULL(CLIENTE_CPFCNPJ,'NÃO INFORMADO')))                                   AS  CLIENTE_CPFCNPJ\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CLIENTE_EMAIL,'NÃO INFORMADO')))                                     AS  CLIENTE_EMAIL\n,CONVERT(VARCHAR(50),UPPER(ISNULL(CLIENTE_CIDADE,'NÃO INFORMADO')))                                     AS  CLIENTE_CIDADE\n,CONVERT(VARCHAR(15), UPPER(ISNULL(CLIENTE_ESTADO,'NÃO INFROAMDO')))                                    AS  CLIENTE_ESTADO\n,CASE\n    WHEN CLIENTE_SEXO = 'M' THEN 'MASCULINO'\n    WHEN CLIENTE_SEXO = 'F' THEN 'FEMININO'\n        ELSE 'NÃO INFORMADO'\nEND                                                                                                     AS CLIENTE_SEXO\n,CONVERT(DATE,ISNULL(CLIENTE_ANIVERSARIO,'1900-01-01'))                                                 AS  CLIENTE_ANIVERSARIO\n,CONVERT(INT,ISNULL(CLIENTE_DDD_CELULAR,-1))                                                            AS  CLIENTE_DDD_CELULAR\n,CONVERT(VARCHAR(10),ISNULL(CLIENTE_CELULAR,-1))                                                        AS  CLIENTE_CELULAR\n\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CLIENTE_ENDERECO,'NÃO INFORMADO')))                                  AS  CLIENTE_ENDERECO\n,CONVERT(VARCHAR(15),ISNULL(CLIENTE_NUMERO,'NÃO INFORMADO'))                                            AS  CLIENTE_NUMERO\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CLIENTE_BAIRRO,'NÃO INFORMADO')))                                    AS  CLIENTE_BAIRRO\n,CASE\n    WHEN NUM_MATRICULA IS NULL OR LEN(NUM_MATRICULA) = 0 THEN   'NÃO INFORMADO'\n        ELSE UPPER(CONVERT(VARCHAR(25),NUM_MATRICULA))\nEND                                                                                                     AS  NUM_MATRICULA\nFROM CLEANSING_DATA.GST_BI_CLIENTES\n\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}