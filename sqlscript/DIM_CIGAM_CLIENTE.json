{
	"name": "DIM_CIGAM_CLIENTE",
	"properties": {
		"folder": {
			"name": "MODELO DIMENSIONAL"
		},
		"content": {
			"query": "SELECT TOP(15)\nCONVERT(VARCHAR(15), UPPER(ISNULL(PK_CLIENTE,'NÃOINFORMADO')))                                          AS  ID_CLIENTE\n,CONVERT(VARCHAR(5), UPPER(ISNULL(ESTAB_IDCIGAM,'NÃOINFORMADO')))                                       AS  ESTAB_IDCIGAM\n,CONVERT(INT,ISNULL(CLIENTE_CODIGO,-1))                                                                 AS  CLIENTE_CODIGO\n,CONVERT(VARCHAR(150), UPPER(ISNULL(CLIENTE_NOME,'NÃO INFORMADO')))                                     AS  CLIENTE_NOME\n,CONVERT(VARCHAR(15), UPPER(ISNULL(CLIENTE_CPFCNPJ,'NÃO INFORMADO')))                                   AS  CLIENTE_CPFCNPJ\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CLIENTE_EMAIL,'NÃO INFORMADO')))                                     AS  CLIENTE_EMAIL\n,CONVERT(VARCHAR(50),UPPER(ISNULL(CLIENTE_CIDADE,'NÃO INFORMADO')))                                     AS  CLIENTE_CIDADE\n,CONVERT(VARCHAR(15), UPPER(ISNULL(CLIENTE_ESTADO,'NÃO INFROAMDO')))                                    AS  CLIENTE_ESTADO\n,CASE\n    WHEN CLIENTE_SEXO = 'M' THEN 'MASCULINO'\n    WHEN CLIENTE_SEXO = 'F' THEN 'FEMININO'\n        ELSE 'NÃO INFORMADO'\nEND                                                                                                     AS CLIENTE_SEXO\n,CONVERT(DATE,ISNULL(CLIENTE_ANIVERSARIO,'1900-01-01'))                                                 AS  CLIENTE_ANIVERSARIO\n,CONVERT(INT,ISNULL(CLIENTE_DDD_CELULAR,-1))                                                            AS  ESTAB_DDD\n,CONVERT(INT,ISNULL(CLIENTE_CELULAR,-1))                                                       AS  ESTAB_TELEFONE\n\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CLIENTE_ENDERECO,'NÃO INFORMADO')))                                  AS  CLIENTE_ENDERECO\n,CONVERT(VARCHAR(15),ISNULL(CLIENTE_NUMERO,'NÃO INFORMADO'))                                            AS  CLIENTE_NUMERO\n,CONVERT(VARCHAR(150),UPPER(ISNULL(CLIENTE_BAIRRO,'NÃO INFORMADO')))                                    AS  CLIENTE_BAIRRO\n,CONVERT(VARCHAR(25),ISNULL(NUM_MATRICULA,'NAO INFORMADO'))                                             AS  NUM_MATRICULA\n\n\nFROM CLEANSING_DATA.GST_BI_CLIENTES\n\n\nSELECT MAX(LEN(NUM_MATRICULA)) FROM CLEANSING_DATA.GST_BI_CLIENTES\nSELECT NUM_MATRICULA FROM CLEANSING_DATA.GST_BI_CLIENTES\nWHERE LEN(NUM_MATRICULA) = 22\n\n\nESTAB_IDCIGAM&'|'&CODIGO_BARRAS\nESTAB_IDCIGAM\nNum(DATA_CONFIRMACAO)\nESTAB_IDCIGAM&'|'&num(DATA_CONFIRMACAO)\nESTAB_IDCIGAM&'|'&NUMERO_DOCTO&'|'&Date(DATA_CONFIRMACAO)\nVALOR_UNITARIO\nVALOR_TOTAL_ITEM * -1\nQTD_ITEM * -1\nQTD_ITEM\nVALOR_TOTAL_ITEM \nPRODUTO\nC'&'|'& ApplyMap('MapCor',CODIGO_BARRAS,Null())\nApplyMap('MapEAN',CODIGO_BARRAS,Null())\nPRODUTO_TAMANHO\nESTAB_IDCIGAM & '|' & CLIENTE_CODIGO\nESTAB_IDCIGAM & '|' & VENDEDOR_CODIGO\nTIPO_MOVIMENTO\n\"NAO\"\nFROM \nFROM CLEANSING_DATA.GST_BI_CLIENTES",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "dwmwe",
				"databaseName": "dwmwe"
			}
		},
		"type": "SqlQuery"
	}
}